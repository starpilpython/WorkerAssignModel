# 인력 배치 시뮬레이션 프로그램

이 프로그램은 인력들의 근무지, 진료과 배치를 최적화하여 자동으로 배정하는 시뮬레이션 도구입니다. Streamlit을 이용하여 웹 인터페이스를 제공하며, `PuLP` 라이브러리를 통해 정수계획법(ILP)으로 최적의 배치 결과를 도출합니다.

## 주요 기능

- **엑셀 파일 업로드**: 배치 조건(인력 수, 각 진료과별 최소/최대 인원 등)이 담긴 엑셀 파일을 업로드하여 시뮬레이션을 수행합니다.
- **실시간 조건 수정**: 웹 화면에서 불러온 데이터를 직접 수정하여 즉시 시뮬레이션에 반영할 수 있습니다.
- **자동 최적화**: 제약 조건(연속 근무 금지, 파견 병원 제한 등)을 고려하여 인턴 배치를 자동으로 수행합니다.
- **결과 시각화 및 다운로드**:
  - 배정 결과 (월별/인력별 배치표)
  - 인력별 근무 일수 집계
  - 진료과별 월별 인원 집계
  - **엑셀 다운로드 기능**: 모든 결과를 하나의 엑셀 파일로 다운로드 가능

## 설치 방법

1.  이 저장소를 클론(Clone)하거나 다운로드합니다.
2.  Python이 설치되어 있어야 합니다. (Python 3.8 이상 권장)
3.  필요한 라이브러리를 설치합니다.

```bash
pip install -r requirements.txt
```

## 실행 방법

터미널(또는 CMD)에서 다음 명령어를 실행합니다.

```bash
streamlit run app.py
```

브라우저가 자동으로 열리며 프로그램이 실행됩니다.

## 사용법

1.  **조건 양식 다운로드**: 우측 상단의 '조건 양식 다운로드' 버튼을 클릭하여 템플릿 엑셀 파일을 받습니다.
2.  **데이터 입력**: 템플릿 파일에 근무지, 진료과, 최소/최대 인원 등의 조건을 입력합니다.
3.  **파일 업로드**: '파일 선택' 영역에 작성한 엑셀 파일을 드래그하거나 클릭하여 업로드합니다.
4.  **조건 확인 및 수정**: 화면에 표시된 데이터 표를 확인하고, 필요한 경우 직접 수정합니다.
5.  **최적화 실행**: 우측의 '⚡ 최적화 실행' 버튼을 클릭합니다.
6.  **결과 확인**: '배정결과', '인력별집계', '구분별집계' 탭을 눌러 결과를 확인합니다.
7.  **엑셀 다운로드**: '📜 Excel 다운' 버튼을 클릭하여 최종 결과를 엑셀 파일로 저장합니다.

## 디렉토리 구조

```
📦 인턴 배치 시뮬레이션 프로그램
 ┣ 📂 model
 ┃ ┗ 📜 intern_assign.py  # 최적화 로직 (PuLP 모델링)
 ┣ 📂 template
 ┃ ┗ 📜 template.xlsx     # 기본 엑셀 양식
 ┣ 📜 app.py              # Streamlit 메인 프로그램
 ┣ 📜 requirements.txt    # 필요 라이브러리 목록
 ┗ 📜 README.md           # 프로그램 설명서
```

## 주요 제약 조건 (모델링)

- 각 인력은 매월 반드시 1개의 진료과에 배치되어야 합니다.
- 각 부서는 월별 최소/최대 인원 제한을 준수해야 합니다.
- 각 인력 특정 진료과 그룹(Main, Out 등)에 정해진 횟수만큼 배치되어야 합니다.
- 연속 근무 금지 조건 (동일 근무지/부서 연속 근무 제한 등)이 적용됩니다.
